# SPEC-004 수락 기준: Windows/macOS/Linux 환경별 최적화

## Acceptance Criteria

### AC1. 플랫폼별 경로 처리 표준화

**Given** Windows 환경에서 MoAI-ADK를 사용할 때
**When** `.moai/` 또는 `.claude/` 디렉토리를 생성하면
**Then** 모든 경로가 백슬래시(`\`) 구분자를 사용하고 Windows 파일명 규칙을 준수해야 함

#### 검증 기준:

- [ ] Windows 경로 구분자 자동 적용 (백슬래시 `\`)
- [ ] Unix 경로 구분자 자동 적용 (슬래시 `/`)
- [ ] 플랫폼별 파일명 길이 제한 준수
- [ ] 특수문자 처리 플랫폼별 호환성 확인

### AC2. 환경별 권한 설정 자동화

**Given** 각 플랫폼에서 MoAI-ADK 설치가 진행될 때
**When** 실행 파일이나 스크립트가 생성되면
**Then** 해당 플랫폼에 적합한 권한이 자동으로 설정되어야 함

#### 검증 기준:

- [ ] Windows ACL 기반 권한 설정 동작
- [ ] macOS/Linux chmod 기반 실행 권한 (755) 자동 부여
- [ ] 관리자 권한 없이 정상 설치 가능
- [ ] 사용자 홈 디렉토리 내 권한 최적화 완료

### AC3. 플랫폼별 설치 스크립트 최적화

**Given** 사용자가 각 플랫폼에서 설치를 시도할 때
**When** `pip install moai-adk` 명령을 실행하면
**Then** 해당 플랫폼에 최적화된 설치 과정이 진행되어야 함

#### 검증 기준:

- [ ] Windows PowerShell 스크립트 지원 확인
- [ ] macOS bash/zsh 스크립트 지원 확인
- [ ] Linux 주요 배포판별 호환성 검증
- [ ] 환경 변수 자동 설정 (PATH, PYTHONPATH) 동작

### AC4. 크로스 플랫폼 호환성 자동 테스트

**Given** 코드 변경이 GitHub에 푸시될 때
**When** CI/CD 파이프라인이 실행되면
**Then** 모든 지원 플랫폼에서 테스트가 통과해야 함

#### 검증 기준:

- [ ] GitHub Actions 멀티 플랫폼 매트릭스 빌드 동작
- [ ] Windows, macOS, Linux 환경별 E2E 테스트 통과
- [ ] 플랫폼별 성능 벤치마크 측정 완료
- [ ] 플랫폼별 패키지 무결성 검증 성공

## 품질 게이트 통과 기준

### 필수 통과 조건

1. **크로스 플랫폼 호환성**: 3개 플랫폼 모든 환경에서 100% 동작
2. **설치 성공률**: 각 플랫폼별 설치 성공률 ≥95%
3. **권한 설정**: 관리자 권한 없이 100% 설치 가능
4. **경로 처리**: 플랫폼별 경로 규칙 100% 준수

### 검증 방법

- **자동화 테스트**: GitHub Actions 매트릭스 빌드로 3개 플랫폼 동시 검증
- **통합 테스트**: 각 플랫폼별 전체 워크플로우 시나리오 테스트
- **성능 테스트**: 플랫폼별 설치/실행 속도 벤치마크 (차이 ≤20%)
- **사용성 테스트**: 실제 사용자 환경에서 설치 및 사용 시나리오 검증

## 완료 조건 (Definition of Done)

### 기능 완료 기준

- [ ] 플랫폼별 경로 처리 표준화 완료
- [ ] 환경별 권한 설정 자동화 구현
- [ ] 플랫폼별 설치 스크립트 최적화 완료
- [ ] 크로스 플랫폼 CI/CD 파이프라인 구축

### 문서화 완료 기준

- [ ] 플랫폼별 설치 가이드 작성
- [ ] 크로스 플랫폼 호환성 문서 완성
- [ ] 플랫폼별 특수 사항 및 제약사항 문서화
- [ ] 트러블슈팅 가이드 (플랫폼별 이슈 해결법)

### 테스트 완료 기준

- [ ] 단위 테스트: 각 플랫폼별 경로/권한 처리 함수 100% 커버리지
- [ ] 통합 테스트: 크로스 플랫폼 설치 시나리오 모든 케이스 통과
- [ ] E2E 테스트: 실제 3개 플랫폼에서 전체 워크플로우 검증 완료
- [ ] 성능 테스트: 플랫폼별 벤치마크 기준선 설정 및 측정

## 플랫폼별 특수 검증 항목

### Windows 환경

- [ ] 긴 경로명 지원 (260자 제한 우회) 검증
- [ ] 예약된 파일명 처리 (CON, PRN, AUX 등) 확인
- [ ] 대소문자 구분하지 않는 파일시스템 호환성 검증
- [ ] PowerShell 실행 정책과의 호환성 확인

### macOS 환경

- [ ] Gatekeeper 보안 정책 준수 확인
- [ ] SIP (System Integrity Protection) 환경에서 정상 동작
- [ ] 번들 앱 구조와의 호환성 검증
- [ ] Homebrew 환경과의 충돌 없음 확인

### Linux 환경

- [ ] 주요 배포판 (Ubuntu, CentOS, Debian) 호환성 검증
- [ ] 다양한 패키지 관리자와의 공존성 확인
- [ ] 컨테이너 환경 (Docker, Podman)에서 정상 동작
- [ ] SELinux 활성화 환경에서 정상 동작

## 회귀 테스트 시나리오

### 핵심 워크플로우 검증

1. **설치 후 즉시 사용**: `pip install moai-adk && /moai:0-project`
2. **크로스 플랫폼 프로젝트**: Git 저장소를 여러 플랫폼에서 클론 후 사용
3. **권한 변경 시나리오**: 파일 권한 변경 후에도 정상 동작
4. **경로 변경 시나리오**: 다양한 디렉토리 구조에서 설치 및 실행

### 오류 복구 시나리오

1. **부분 설치 실패**: 중간에 중단된 설치 재시도 시 정상 복구
2. **권한 부족**: 권한 부족 상황에서 적절한 오류 메시지 및 해결 방법 제시
3. **디스크 공간 부족**: 공간 부족 시 정리 및 재시도 가이드 제공
4. **네트워크 장애**: 오프라인 상황에서 로컬 기능 정상 동작

---

**연결된 SPEC**:

- SPEC-004 명세서: [spec.md](./spec.md)
- 구현 계획: [plan.md](./plan.md)

**관련 TAG**: @TEST:ACCEPTANCE-004, @CODE:CROSS-PLATFORM-001
